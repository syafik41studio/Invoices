<h2>Messages</h2>
<div class="tag_menu">
  <!--<a class="btn_search" href="#"></a>-->
  <input type="text" id="input-search-conversation" name="conversation_id" />
  <%= link_to "+ New Message", new_conversation_path, :class => "btn_newmessage", :id => "create-user", :remote => true %>
  <div style="clear:both"></div>
</div>
<div id="list-messages">
  <% @conversations.each do |conversation| %>
    <div id="conversation-<%= conversation.id %>">
      <%= render "conversation", {:conversation => conversation} %>
    </div>
  <% end %>
</div>

<script type="text/javascript">
  $(document).ready(function() {
    $("#input-search-conversation").tokenInput("/search_conversations_by_name.json", {
      propertyToSearch: "full_name",
      resultsFormatter: function(item){ return "<li>" + "<img src='" + item.url + "' title='" + item.first_name + " " + item.last_name + "' height='25px' width='25px' />" + "<div style='display: inline-block; padding-left: 10px;'><div class='full_name'>" + item.first_name + " " + item.last_name + "</div><div class='email'>" + item.email + "</div></div></li>" },
      tokenFormatter: function(item) { return "<li><p>" + item.first_name + " <b style='color: red'>" + item.last_name + "</b></p></li>" }
    });
    $('.token-input-list').css({"float":"right", "clear":"none","margin-left":"10px"});
    $('.token-input-list').addClass("ui-corner-all");
  });
</script>
